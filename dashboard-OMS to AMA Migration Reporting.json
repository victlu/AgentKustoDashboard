{"$schema":"https://dataexplorer.azure.com/static/d/schema/24/dashboard.json","id":"7c075703-b846-40a4-b06e-08b0a631c3df","eTag":"zZugA6BtEyulKUCf9ottfg==","title":"OMS to AMA Migration Reporting","tiles":[{"id":"596b4c2d-9791-40cf-8b49-434b0e548ac8","title":"OMS Linux Population Trend","query":"//OMS Linux Population Trend\n\nunion (cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshotOld | where Date < datetime(2020-06-28)), cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot\n| summarize DailyCount = count() by Date\n| summarize MonthlyMax = max(DailyCount) by endofmonth(Date)\n| render timechart","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"line","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":0,"width":12,"height":9},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"ff3dc625-a82d-4219-871a-3606dad1f516","title":"OMS Windows Population Trend","query":"//OMS Windows Population Trend\n\ncluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot\n| summarize DailyCount = count() by Date\n| summarize MonthlyMax = max(DailyCount) by endofmonth(Date)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"line","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":0,"width":12,"height":9},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"f83e742d-2daf-4271-b114-a54f4c2f28a9","title":"Top 50 customers of OMS based off agent count","query":"//Top customers OMS by AgentId Count\n\nlet WorkspaceOS = union\n        Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot),\n        Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n    | extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n    | summarize\n        HasWindows = countif(OSType == \"Windows\") > 0,\n        HasLinux = countif(OSType == \"Linux\") > 0\n        by WorkspaceId;\nlet topCustomerId =\nunion\n    Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot),\n    Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| extend Id = tostring(split(ResourceId, \"/\")[2])\n| where Id != \"\"\n| summarize\n    TotalAgentCount = dcount(AgentId),\n    WinAgentCount = dcountif(AgentId, OSType == \"Windows\"),\n    LnxAgentCount = dcountif(AgentId, OSType == \"Linux\") by Id\n| sort by TotalAgentCount desc\n| take 50;\ntopCustomerId\n| join kind = leftouter cluster('genevareference.westcentralus.kusto.windows.net').database('AzureGraph').\nCustomer_Subscription on Id\n| project Name, TotalAgentCount, WinAgentCount, LnxAgentCount, Id = CloudCustomer\n| join kind = leftouter cluster('genevareference.westcentralus.kusto.windows.net').database('AzureGraph').\nCustomer_CloudCustomer on Id\n| project Name, TotalAgentCount, WinAgentCount, LnxAgentCount, IndustryName\n| sort by TotalAgentCount","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"table","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":9,"width":24,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"cbdd36e4-b5d8-4387-9092-1eb982f05ec2","title":"Top 50 customers of AMA based off agent count ","query":"//AMA Pop by agent version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (now(-90d) .. now())\n| where Name =~ \"microsoft.azure.monitor.azuremonitorwindowsagent\" or Name =~ \"microsoft.azure.monitor.azuremonitorlinuxagent\"\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| where OperationSuccess == true\n| project\n    Version,\n    VMId,\n    SubscriptionId,\n    OS = iff(Name =~ \"microsoft.azure.monitor.azuremonitorlinuxagent\", \"Linux\", \"Windows\")\n| summarize\n    TotalAgentCount = dcount(VMId), \n    WinAgentCount = dcountif(VMId,OS == \"Windows\"),\n    LnxAgentCount = dcountif(VMId,OS == \"Linux\")\n    by SubscriptionId\n| take 50\n| extend Id = SubscriptionId\n| join kind = leftouter cluster('genevareference.westcentralus.kusto.windows.net').database('AzureGraph').\nCustomer_Subscription on Id\n| project Name, TotalAgentCount, WinAgentCount, LnxAgentCount, Id = CloudCustomer\n| join kind = leftouter cluster('genevareference.westcentralus.kusto.windows.net').database('AzureGraph').\nCustomer_CloudCustomer on Id\n| project Name, TotalAgentCount, WinAgentCount, LnxAgentCount, IndustryName\n| sort by TotalAgentCount","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"table","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":22,"width":24,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}}],"dataSources":[{"id":"81c7dec3-36d3-46ff-96fc-9751a73cae68","name":"geneva agent","clusterUri":"https://genevaagent.kusto.windows.net/","database":"AMA","kind":"manual-kusto","scopeId":"kusto"}],"schema_version":"24","autoRefresh":{"enabled":false},"parameters":[],"pages":[{"name":"OMS","id":"9db0948a-e66b-437f-a1a8-a5a0921776c9"}]}