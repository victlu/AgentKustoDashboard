{"$schema":"https://dataexplorer.azure.com/static/d/schema/24/dashboard.json","id":"89207b21-b14f-4143-8c68-d2dcbef75882","eTag":"DlU4zQKDMhJ4q413TbYI3g==","title":"Multi-Populations","tiles":[{"id":"a36d689e-fc47-4593-9abc-205979faf920","title":"Total Population Count","query":"//LAD/WAD for all Installed or Enabled Count\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD'])\n| where OperationSuccess == true\n| where Name in~ ( \"microsoft.azure.diagnostics.iaasdiagnostics\",\"microsoft.azure.diagnostics.paasdiagnostics\",\"microsoft.azure.diagnostics.edp.iaasdiagnostics\",\"microsoft.azure.diagnostics.edp.paasdiagnostics\",\"microsoft.azure.diagnostics.linuxdiagnostic\", \"microsoft.ostcextensions.linuxdiagnostic\",\"microsoft.ostcextensions.edp.linuxdiagnostic\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| project\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":0,"y":0,"width":8,"height":3},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"54b2cd4e-b3e7-41c3-b3b3-c828989fe634","title":"Agent Version Windows Population","query":"//LAD/WAD Windows Pop by agent version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD'])\n| where OperationSuccess == true\n| where Name in~ ( \"microsoft.azure.diagnostics.iaasdiagnostics\",\"microsoft.azure.diagnostics.paasdiagnostics\",\"microsoft.azure.diagnostics.edp.iaasdiagnostics\",\"microsoft.azure.diagnostics.edp.paasdiagnostics\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| project\n    Version,\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId) by Version\n| where TotalResourceCount > 0\n| sort by TotalResourceCount\n| take 32","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":0,"y":3,"width":12,"height":11},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"d87163e5-9655-4264-918c-1a23694118ca","title":"Top Windows OS Populations","query":"//Current pop by OS version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD']) // Time range filtering\n| where Name in~ ( \"microsoft.azure.diagnostics.iaasdiagnostics\",\"microsoft.azure.diagnostics.paasdiagnostics\",\"microsoft.azure.diagnostics.edp.iaasdiagnostics\",\"microsoft.azure.diagnostics.edp.paasdiagnostics\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| where OperationSuccess == true\n| project\n    OSVersion,\n    VMId\n| summarize\n    OSResourceCount = dcount(VMId)\n    by OSVersion\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":0,"y":14,"width":12,"height":9},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"7a90ee43-4663-45a4-8205-6b48ad8b51a8","title":"Top Region Windows Populations","query":"//Current Windows pop by Region\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD']) // Time range filtering\n| where OperationSuccess == true\n| where Name in~ ( \"microsoft.azure.diagnostics.iaasdiagnostics\",\"microsoft.azure.diagnostics.paasdiagnostics\",\"microsoft.azure.diagnostics.edp.iaasdiagnostics\",\"microsoft.azure.diagnostics.edp.paasdiagnostics\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| project\n    Region,\n    VMId\n| summarize\n    OSResourceCount = dcount(VMId)\n    by Region\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":0,"y":33,"width":12,"height":11},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"12bec796-9a72-47d7-8eb6-506cd93d436f","title":"Total Population Count","query":"//AMA for all Installed or Enabled Count\n\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA'])\n| where tolower(Name) == \"microsoft.azure.monitor.azuremonitorwindowsagent\" or tolower(Name) == \"microsoft.azure.monitor.azuremonitorlinuxagent\"\n| where isempty(['_OSselected_AMA']) or tolower(Name) in (['_OSselected_AMA'])\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| where OperationSuccess == true\n| project\n    Name,\n    TIMESTAMP,\n    Operation,\n    OperationSuccess,\n    Version,\n    Region,\n    VMId,\n    isWin=tolower(Name) == \"microsoft.azure.monitor.azuremonitorwindowsagent\",\n    isLnx=tolower(Name) == \"microsoft.azure.monitor.azuremonitorlinuxagent\",\n    WinInstalled = (Operation == \"OnPluginInstallEnd\" and OperationSuccess == true),\n    WinEnabled = (Operation == \"OnPluginEnableEnd\" and OperationSuccess == true),\n    LnxInstalled = (Operation == \"Install\" and OperationSuccess == true),\n    LnxEnabled = (Operation == \"Enable\" and OperationSuccess == true)\n| summarize\n    TotalResourceCount = dcount(VMId)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":0,"y":0,"width":8,"height":3},"usedParamVariables":["_OSselected_AMA","_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"e87113f8-d4e2-4521-9615-49949c8f05ec","title":"Agent Version Windows Population","query":"//AMA Pop by agent version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA'])\n| where Name =~ \"microsoft.azure.monitor.azuremonitorwindowsagent\"\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| where OperationSuccess == true\n| project\n    Version,\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId) by Version\n| where TotalResourceCount > 0\n| sort by TotalResourceCount","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":0,"y":3,"width":11,"height":9},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"1d7db75d-9895-45d0-9b83-b1c058f45e92","title":"Top Windows Version Populations","query":"//Current pop by Windows OS version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA']) // Time range filtering\n| where Name =~ \"microsoft.azure.monitor.azuremonitorwindowsagent\"\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| where OperationSuccess == true\n| project\n    OSVersion,\n    VMId\n| summarize\n    OSResourceCount = dcount(VMId)\n    by OSVersion\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":0,"y":12,"width":11,"height":9},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"a2b072e0-7977-4df2-90f0-8da0eee0b0f8","title":"Top Region Windows Populations","query":"//AMA Windows Pop by region\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA'])\n| where Name =~ \"microsoft.azure.monitor.azuremonitorwindowsagent\"\n| where OperationSuccess == true\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| project\n    Region,\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId) by Region\n| where TotalResourceCount > 0\n| sort by TotalResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":0,"y":32,"width":11,"height":11},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"01543075-8b33-44ea-a1d7-703af0cd9dfa","title":"Grouped Region Windows Populations","query":"//AMA Windows Pop by region grouped\nlet locAustralia = dynamic([\"australiacentral\", \"australiacentral2\", \"australiaeast\", \"australiasoutheast\"]);\nlet locSouthAmerica = dynamic([\"brazilsouth\", \"brazilsoutheast\" ]);\nlet locNorthAmerica = dynamic([\"canadacentral\", \"canadaeast\", \"centralus\", \"eastus\", \"eastus2\", \"northcentralus\", \"southcentralus\", \"westcentralus\", \"westus\", \"westus2\", \"westus3\"]);\nlet locIndia = dynamic([\"centralindia\", \"jioindiacentral\", \"jioindiawest\", \"southindia\", \"westindia\"]);\nlet locAsia = dynamic([\"eastasia\", \"southeastasia\", \"japaneast\", \"japanwest\", \"koreacentral\", \"koreasouth\"]);\nlet locEurope = dynamic([\"francecentral\", \"francesouth\", \"germanynorth\", \"germanywestcentral\", \"northeurope\", \"westeurope\", \"norwayeast\", \"norwaywest\", \"swedencentral\", \"swedensouth\", \"switzerlandnorth\", \"switzerlandwest\", \"uksouth\", \"ukwest\"]);\nlet locMidEast = dynamic([\"qatarcentral\", \"uaecentral\", \"uaenorth\"]);\nlet locAfrica = dynamic([\"southafricanorth\", \"southafricawest\"]);\nlet locEUAP = dynamic([\"centraluseuap\", \"eastus2euap\"]);\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA'])\n| where Name =~ \"microsoft.azure.monitor.azuremonitorwindowsagent\"\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| where OperationSuccess == true\n| project\n    Region,\n    VMId\n| extend GroupRegion = iif(Region in (['locAustralia']), \"Australia\", iif(Region in (['locSouthAmerica']), \"South America\", iif(Region in (['locNorthAmerica']), \"North America\", iif(Region in (['locIndia']), \"India\", iif(Region in (['locAsia']), \"Asia\", iif(Region in (['locEurope']), \"Europe\", iif(Region in (['locMidEast']), \"MidEast\", iif(Region in (['locAfrica']), \"Africa\", iif(Region endswith \"euap\", \"EUAP\", \"Other\")))))))))\n| summarize\n    TotalResourceCount = dcount(VMId) by GroupRegion\n| where TotalResourceCount > 0\n| sort by TotalResourceCount","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":0,"y":43,"width":11,"height":10},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"a328ef40-0ba4-4339-b439-ed8c61a7a892","title":"Region Group Windows Populations","query":"//Current Windows pop by Grouped Region\nlet locAustralia = dynamic([\"australiacentral\", \"australiacentral2\", \"australiaeast\", \"australiasoutheast\"]);\nlet locSouthAmerica = dynamic([\"brazilsouth\", \"brazilsoutheast\" ]);\nlet locNorthAmerica = dynamic([\"canadacentral\", \"canadaeast\", \"centralus\", \"eastus\", \"eastus2\", \"northcentralus\", \"southcentralus\", \"westcentralus\", \"westus\", \"westus2\", \"westus3\"]);\nlet locIndia = dynamic([\"centralindia\", \"jioindiacentral\", \"jioindiawest\", \"southindia\", \"westindia\"]);\nlet locAsia = dynamic([\"eastasia\", \"southeastasia\", \"japaneast\", \"japanwest\", \"koreacentral\", \"koreasouth\"]);\nlet locEurope = dynamic([\"francecentral\", \"francesouth\", \"germanynorth\", \"germanywestcentral\", \"northeurope\", \"westeurope\", \"norwayeast\", \"norwaywest\", \"swedencentral\", \"swedensouth\", \"switzerlandnorth\", \"switzerlandwest\", \"uksouth\", \"ukwest\"]);\nlet locMidEast = dynamic([\"qatarcentral\", \"uaecentral\", \"uaenorth\"]);\nlet locAfrica = dynamic([\"southafricanorth\", \"southafricawest\"]);\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD']) // Time range filtering\n| where OperationSuccess == true\n| where Name in~ ( \"microsoft.azure.diagnostics.iaasdiagnostics\",\"microsoft.azure.diagnostics.paasdiagnostics\",\"microsoft.azure.diagnostics.edp.iaasdiagnostics\",\"microsoft.azure.diagnostics.edp.paasdiagnostics\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| project\n    Region,\n    VMId\n|extend GroupRegion = iif(Region in (['locAustralia']), \"Australia\", iif(Region in (['locSouthAmerica']), \"South America\", iif(Region in (['locNorthAmerica']), \"North America\", iif(Region in (['locIndia']), \"India\", iif(Region in (['locAsia']), \"Asia\", iif(Region in (['locEurope']), \"Europe\", iif(Region in (['locMidEast']), \"MidEast\", iif(Region in (['locAfrica']), \"Africa\", iif(Region endswith \"euap\", \"EUAP\", \"Other\")))))))))\n| summarize\n    ResourceCount = dcount(VMId)\n    by GroupRegion\n| where ResourceCount > 0\n| sort by ResourceCount","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":0,"y":44,"width":12,"height":11},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"e43681de-83a7-4a99-b411-8d7c87a7fb21","title":"Arc/Non-Arc Windows Population","query":"//Windows Pop by Arc type\nHealthSummaryDaily\n| where StartTime > ago(90d)\n| where OSVer has \"windows\"\n| project ResourceId\n| extend Arc = iif(ResourceId has \"/microsoft.HybridCompute/\", \"ARC\", \"NON-ARC\")\n| summarize totalResourceCount = dcount(ResourceId) by Arc\n| where totalResourceCount > 0\n| sort by totalResourceCount\n","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":0,"y":53,"width":11,"height":8},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"3fcbc146-5530-43dc-b874-9f199e6dbf3a","title":"Top Grouped Windows OS Populations","query":"//Current windows os population grouped\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA']) // Time range filtering\n| where Name =~ \"microsoft.azure.monitor.azuremonitorwindowsagent\"\n| where OperationSuccess == true\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| where OSVersion != \"\"\n| project\n    OSVersion,\n    Region,\n    VMId\n| extend OS_gen = replace_string(OSVersion, 'Windows:', '')\n| extend OS_gen = replace_string(OS_gen, 'Linux:', '')\n| extend OS_gen = replace_string(OS_gen, 'DataCenter', 'Datacenter')\n| extend OS_gen = replace_regex(OS_gen, @'(\\D.*)(\\d+)\\.(\\d+)\\..*', @'\\1\\2.\\3')\n| extend OS_gen = replace_regex(OS_gen, @'(\\d\\d\\d\\d.*?)[-].*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Standard).*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Datacenter).*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Windows \\d+ \\D+?)[ -].*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(\\D+.\\d+\\.\\d+).*', @'\\1')\n| summarize\n    OSResourceCount = dcount(VMId)\n    by OS_gen\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":0,"y":21,"width":11,"height":11},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"dc2fb6b0-0be2-4d4c-a0e3-11648fae694e","title":"Top Grouped Windows OS Populations","query":"//Current pop by OS version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD']) // Time range filtering\n| where OperationSuccess == true\n| where Name in~ ( \"microsoft.azure.diagnostics.iaasdiagnostics\",\"microsoft.azure.diagnostics.paasdiagnostics\",\"microsoft.azure.diagnostics.edp.iaasdiagnostics\",\"microsoft.azure.diagnostics.edp.paasdiagnostics\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| where OSVersion != \"\"\n| project\n    OSVersion,\n    VMId\n| extend OS_gen = replace_string(OSVersion, 'Windows:', '')\n| extend OS_gen = replace_string(OS_gen, 'Linux:', '')\n| extend OS_gen = replace_string(OS_gen, 'DataCenter', 'Datacenter')\n| extend OS_gen = replace_regex(OS_gen, @'(\\D.*)(\\d+)\\.(\\d+)\\..*', @'\\1\\2.\\3')\n| extend OS_gen = replace_regex(OS_gen, @'(\\d\\d\\d\\d.*?)[-].*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Standard).*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Datacenter).*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Windows \\d+ \\D+?)[ -].*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(\\D+.\\d+\\.\\d+).*', @'\\1')\n| summarize\n    OSResourceCount = dcount(VMId)\n    by OS_gen\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":0,"y":23,"width":12,"height":10},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"3b0919e1-3e5f-4bce-ad1d-5ed80b9cdb91","title":"Top Linux Version Populations","query":"//Current pop by Linux OS version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA']) // Time range filtering\n| where Name =~ \"microsoft.azure.monitor.azuremonitorlinuxagent\"\n| where OperationSuccess == true\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| project\n    OSVersion,\n    VMId\n| summarize\n    OSResourceCount = dcount(VMId)\n    by OSVersion\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":11,"y":12,"width":11,"height":9},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"bf428851-51f7-4bdf-9d63-9f2595eef36e","title":"Solutions Pop by Windows Agent Count","query":"// Windows Agent Count by Solutions For OMS\n//cluster('genevaagent.kusto.windows.net').database('Telemetry').\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| mv-expand Solution to typeof(string)\n| where Solution != \"null\"\n| summarize WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), LinuxAgentCount = dcountif(AgentId, OSType == \"Linux\"), WorkspaceCount = dcount(WorkspaceId) by Solution\n| sort by WinAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":86,"width":12,"height":12},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"3da919c9-5784-4751-bb82-185c26280d32","title":"Windows Arc  vs Non_Arc  Resource Pop","query":"//Windows arc vs nonarc for OMS\n//cluster('genevaagent.kusto.windows.net').database('Telemetry').\n\nlet Windows = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot) | extend OSType = \"Windows\";\nWindows\n| extend arcType = iff(ResourceId contains \"microsoft.hybridcompute\", \"Arc\", \"Non_Arc\")\n| summarize Resources = dcount(ResourceId)\n            by arcType","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":98,"width":12,"height":8},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"specified","value":["Resources"]},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"c0e4eae5-8058-41c7-9a87-d0cbcaaaa0b4","title":"Top Grouped Linux OS Populations","query":"//Current Linux OS Populations\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA']) // Time range filtering\n| where Name =~ \"microsoft.azure.monitor.azuremonitorlinuxagent\"\n| where OperationSuccess == true\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| where OSVersion != \"\"\n| project\n    OSVersion,\n    VMId\n| extend OS_gen = replace_string(OSVersion, 'Windows:', '')\n| extend OS_gen = replace_string(OS_gen, 'Linux:', '')\n| extend OS_gen = replace_string(OS_gen, 'DataCenter', 'Datacenter')\n| extend OS_gen = replace_regex(OS_gen, @'(\\D.*)(\\d+)\\.(\\d+)\\..*', @'\\1\\2.\\3')\n| extend OS_gen = replace_regex(OS_gen, @'(\\d\\d\\d\\d.*?)[-].*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Standard).*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Datacenter).*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Windows \\d+ \\D+?)[ -].*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(\\D+.\\d+\\.\\d+).*', @'\\1')\n| summarize\n    OSResourceCount = dcount(VMId)\n    by OS_gen\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":11,"y":21,"width":11,"height":11},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"fef68856-9074-4d46-bd81-7be018047588","title":"Top Grouped Linux OS Populations","query":"//Current pop by OS version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD']) // Time range filtering\n| where OperationSuccess == true\n| where Name in~ (\"microsoft.azure.diagnostics.linuxdiagnostic\", \"microsoft.ostcextensions.linuxdiagnostic\",\"microsoft.ostcextensions.edp.linuxdiagnostic\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| where OSVersion != \"\"\n| project\n    OSVersion,\n    VMId\n| extend OS_gen = replace_string(OSVersion, 'Windows:', '')\n| extend OS_gen = replace_string(OS_gen, 'Linux:', '')\n| extend OS_gen = replace_string(OS_gen, 'DataCenter', 'Datacenter')\n| extend OS_gen = replace_regex(OS_gen, @'(\\D.*)(\\d+)\\.(\\d+)\\..*', @'\\1\\2.\\3')\n| extend OS_gen = replace_regex(OS_gen, @'(\\d\\d\\d\\d.*?)[-].*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Standard).*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Datacenter).*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(Windows \\d+ \\D+?)[ -].*', @'\\1')\n| extend OS_gen = replace_regex(OS_gen, @'(\\D+.\\d+\\.\\d+).*', @'\\1')\n| summarize\n    OSResourceCount = dcount(VMId)\n    by OS_gen\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":12,"y":23,"width":12,"height":10},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"8be3c60a-1c6c-4f35-8917-083c5a1ecb72","title":"Top Linux OS Populations","query":"//Current pop by OS version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD']) // Time range filtering\n| where OperationSuccess == true\n| where Name in~ (\"microsoft.azure.diagnostics.linuxdiagnostic\", \"microsoft.ostcextensions.linuxdiagnostic\",\"microsoft.ostcextensions.edp.linuxdiagnostic\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| project\n    OSVersion,\n    VMId\n| summarize\n    OSResourceCount = dcount(VMId)\n    by OSVersion\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":12,"y":14,"width":12,"height":9},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"4d40c878-eccd-43c5-a31a-ee519a41a3c8","title":"OMS Arc Resource Pop By OS","query":"//arc for OMS\n//cluster('genevaagent.kusto.windows.net').database('Telemetry').\n\nlet Linux = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot) | extend OSType = \"Linux\";\nlet Windows = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot) | extend OSType = \"Windows\";\nunion Linux, Windows\n| summarize ArcResources = dcountif(ResourceId, ResourceId contains \"microsoft.hybridcompute\")\n            by OSType","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":106,"width":12,"height":8},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"specified","value":["ArcResources"]},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"7c0f38e4-782c-43b3-bc4e-85e4e52de12d","title":"Linux Arc  vs Non_Arc Resource Pop","query":"//arc for OMS\n//cluster('genevaagent.kusto.windows.net').database('Telemetry').\n\nlet Linux = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot) | extend OSType = \"Linux\";\nLinux\n| extend arcType = iff(ResourceId contains \"microsoft.hybridcompute\", \"Arc\", \"Non_Arc\")\n| summarize Resources = dcount(ResourceId)\n            by arcType","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":98,"width":12,"height":8},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"specified","value":["Resources"]},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"b85c0e65-f206-47a7-96c5-a236f75f38d3","title":"Solutions Pop by Linux Agent Count","query":"// Linux Agent Population of Solutions For OMS\n//cluster('genevaagent.kusto.windows.net').database('Telemetry').\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| mv-expand Solution to typeof(string)\n| where Solution != \"null\"\n| summarize LinuxAgentCount = dcountif(AgentId, OSType == \"Linux\"), WorkspaceCount = dcount(WorkspaceId), WinAgentCount = dcountif(AgentId, OSType == \"Windows\") by Solution\n| sort by LinuxAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":86,"width":12,"height":12},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"185044c4-e9f3-46b0-8d99-99ba8e95c9f4","title":"Windows Agent Population by OS Version","query":"// Windows Agent Population by OS Version\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| extend WindowsOSVersion = strcat(\"Windows \",OSVersion)\n| summarize WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), WinResourceCount = dcountif(ResourceId, OSType == \"Windows\"),  WinWorkspaceCount = dcountif(WorkspaceId, OSType == \"Windows\") by WindowsOSVersion\n| where WinAgentCount > 0\n| sort by WinAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":41,"width":12,"height":12},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"3f8e70e3-35f5-4c50-95e2-e921e208999b","title":"Windows Agent Versions by AgentId Population","query":"//Agent Versions by Windows AgentId Population\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), WinResourceCount = dcountif(ResourceId, OSType == \"Windows\"), WinWorkspaceCount = dcountif(WorkspaceId, OSType == \"Windows\") by AgentVersion\n| sort by WinAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":28,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"0ea7bbcb-cf3d-4395-a01c-f61d60a43b21","title":"Linux Agent Versions by AgentId Population","query":"// Windows Region Count by Solutions For OMS\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize LnxAgentCount = dcountif(AgentId, OSType == \"Linux\"), LnxResourceCount = dcountif(ResourceId, OSType == \"Linux\"), LnxWorkspaceCount = dcountif(WorkspaceId, OSType == \"Linux\") by AgentVersion\n| sort by LnxAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":28,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"3ea2fb7a-b25c-4e38-8511-ac14a7c77760","title":"Total ResourceId Count","query":"//Total ResourceId Count\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize TotalAgentCount = dcount(AgentId), WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), LnxAgentCount = dcountif(AgentId, OSType == \"Linux\"), TotalResourceCount = dcount(ResourceId), WinResourceCount = dcountif(ResourceId, OSType == \"Windows\"), LnxResourceCount = dcountif(ResourceId, OSType == \"Linux\"), TotalWorkspaceCount = dcount(WorkspaceId), WinWorkspaceCount = dcountif(WorkspaceId, OSType == \"Windows\"), LnxWorkspaceCount = dcountif(WorkspaceId, OSType == \"Linux\")","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":0,"width":8,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"specified","value":"TotalResourceCount"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"24fc6da1-98a4-4b87-b4d8-5ff5cb6c2395","title":"Windows ResourceId Count","query":"//Windows ResourceId Count\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize TotalAgentCount = dcount(AgentId), WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), LnxAgentCount = dcountif(AgentId, OSType == \"Linux\"), TotalResourceCount = dcount(ResourceId), WinResourceCount = dcountif(ResourceId, OSType == \"Windows\"), LnxResourceCount = dcountif(ResourceId, OSType == \"Linux\"), TotalWorkspaceCount = dcount(WorkspaceId), WinWorkspaceCount = dcountif(WorkspaceId, OSType == \"Windows\"), LnxWorkspaceCount = dcountif(WorkspaceId, OSType == \"Linux\")","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":8,"y":0,"width":8,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"specified","value":"WinResourceCount"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"0fd897d7-3994-4bd0-9cd1-710f22c64b7c","title":"Linux ResourceId Count","query":"//Linux ResourceId Count\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize TotalAgentCount = dcount(AgentId), WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), LnxAgentCount = dcountif(AgentId, OSType == \"Linux\"), TotalResourceCount = dcount(ResourceId), WinResourceCount = dcountif(ResourceId, OSType == \"Windows\"), LnxResourceCount = dcountif(ResourceId, OSType == \"Linux\"), TotalWorkspaceCount = dcount(WorkspaceId), WinWorkspaceCount = dcountif(WorkspaceId, OSType == \"Windows\"), LnxWorkspaceCount = dcountif(WorkspaceId, OSType == \"Linux\")","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":16,"y":0,"width":8,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"specified","value":"LnxResourceCount"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"b1f57641-758d-4d2e-b62f-aae93d0f9da9","title":"Windows Agent Versions ResourceId Population","query":"// Agent Versions by Windows ResourceId Population\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize WinResourceCount = dcountif(ResourceId, OSType == \"Windows\"), WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), WinWorkspaceCount = dcountif(WorkspaceId, OSType == \"Windows\") by AgentVersion\n| sort by WinResourceCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":15,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"070e9c5b-affd-4a95-86a4-fd222c8538d7","title":"Linux Agent Versions ResourceId Population","query":"// Linux Region Count by Solutions For OMS\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize LnxResourceCount = dcountif(ResourceId, OSType == \"Linux\"), LnxAgentCount = dcountif(AgentId, OSType == \"Linux\"),  LnxWorkspaceCount = dcountif(WorkspaceId, OSType == \"Linux\") by AgentVersion\n| sort by LnxResourceCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":15,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"ddd5395f-edb1-48fd-8dd2-a31e43d594b6","title":"Linux Agent Population by OS Version","query":"// Linux Agent Population by OS Version\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| extend linuxOSVersion = strcat(OSDistro,\" \",OSVersion)\n| summarize LnxAgentCount = dcountif(AgentId, OSType == \"Linux\"), LnxResourceCount = dcountif(ResourceId, OSType == \"Linux\"), LnxWorkspaceCount = dcountif(WorkspaceId, OSType == \"Linux\") by linuxOSVersion\n| where LnxAgentCount > 0\n| sort by LnxAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":41,"width":12,"height":12},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"37be081c-0f4a-426a-8711-45100eb102c2","title":"OMS Non-Arc Resource Pop By OS","query":"//arc for OMS\n//cluster('genevaagent.kusto.windows.net').database('Telemetry').\n\nlet Linux = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot) | extend OSType = \"Linux\";\nlet Windows = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot) | extend OSType = \"Windows\";\nunion Linux, Windows\n| summarize NonArcResources = dcountif(ResourceId, ResourceId notcontains \"microsoft.hybridcompute\")\n            by OSType","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":106,"width":12,"height":8},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"67a38df4-8d78-466c-8b19-305af95b2710","title":"Windows Agent Count by Region","query":"// Windows Populations by Region\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| where Region != \"onpremise\"\n| summarize WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), WinResourceCount = dcountif(ResourceId, OSType == \"Windows\"),  WinWorkspaceCount = dcountif(WorkspaceId, OSType == \"Windows\") by Region\n| sort by WinAgentCount desc\n| take 12","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"bar","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":60,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"d05d6bf4-ed88-4ff7-b1b4-227717cccc71","title":"Linux Agent Count by Region","query":"// Linux Populations by Region\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize LnxAgentCount = dcountif(AgentId, OSType == \"Linux\"), LnxResourceCount = dcountif(ResourceId, OSType == \"Linux\"),  LnxWorkspaceCount = dcountif(WorkspaceId, OSType == \"Linux\") by Region\n| sort by LnxAgentCount desc\n| take 12","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"bar","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":60,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"6f00199a-d974-48f7-a17c-d1b8f133c5ee","title":"Windows Agent Population by Grouped Region","query":"// Windows Agent Population by Region\nlet locAustralia = dynamic([\"australiacentral\", \"australiacentral2\", \"australiaeast\", \"australiasoutheast\"]);\nlet locSouthAmerica = dynamic([\"brazilsouth\", \"brazilsoutheast\" ]);\nlet locNorthAmerica = dynamic([\"canadacentral\", \"canadaeast\", \"centralus\", \"eastus\", \"eastus2\", \"northcentralus\", \"southcentralus\", \"westcentralus\", \"westus\", \"westus2\", \"westus3\"]);\nlet locIndia = dynamic([\"centralindia\", \"jioindiacentral\", \"jioindiawest\", \"southindia\", \"westindia\"]);\nlet locAsia = dynamic([\"eastasia\", \"southeastasia\", \"japaneast\", \"japanwest\", \"koreacentral\", \"koreasouth\"]);\nlet locEurope = dynamic([\"francecentral\", \"francesouth\", \"germanynorth\", \"germanywestcentral\", \"northeurope\", \"westeurope\", \"norwayeast\", \"norwaywest\", \"swedencentral\", \"swedensouth\", \"switzerlandnorth\", \"switzerlandwest\", \"uksouth\", \"ukwest\"]);\nlet locMidEast = dynamic([\"qatarcentral\", \"uaecentral\", \"uaenorth\"]);\nlet locAfrica = dynamic([\"southafricanorth\", \"southafricawest\"]);\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| where Region != \"onpremise\"\n| extend GroupRegion = iif(Region in (['locAustralia']), \"Australia\", iif(Region in (['locSouthAmerica']), \"South America\", iif(Region in (['locNorthAmerica']), \"North America\", iif(Region in (['locIndia']), \"India\", iif(Region in (['locAsia']), \"Asia\", iif(Region in (['locEurope']), \"Europe\", iif(Region in (['locMidEast']), \"MidEast\", iif(Region in (['locAfrica']), \"Africa\", iif(Region endswith \"euap\", \"EUAP\", \"Other\")))))))))\n| summarize WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), WinResourceCount = dcountif(ResourceId, OSType == \"Windows\"),  WinWorkspaceCount = dcountif(WorkspaceId, OSType == \"Windows\") by GroupRegion\n| sort by WinAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":73,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"36bc4748-5a07-4f3c-882a-98172daf040a","title":"Linux Agent Population by Grouped Region","query":"// Linux Agent Population by Region\nlet locAustralia = dynamic([\"australiacentral\", \"australiacentral2\", \"australiaeast\", \"australiasoutheast\"]);\nlet locSouthAmerica = dynamic([\"brazilsouth\", \"brazilsoutheast\" ]);\nlet locNorthAmerica = dynamic([\"canadacentral\", \"canadaeast\", \"centralus\", \"eastus\", \"eastus2\", \"northcentralus\", \"southcentralus\", \"westcentralus\", \"westus\", \"westus2\", \"westus3\"]);\nlet locIndia = dynamic([\"centralindia\", \"jioindiacentral\", \"jioindiawest\", \"southindia\", \"westindia\"]);\nlet locAsia = dynamic([\"eastasia\", \"southeastasia\", \"japaneast\", \"japanwest\", \"koreacentral\", \"koreasouth\"]);\nlet locEurope = dynamic([\"francecentral\", \"francesouth\", \"germanynorth\", \"germanywestcentral\", \"northeurope\", \"westeurope\", \"norwayeast\", \"norwaywest\", \"swedencentral\", \"swedensouth\", \"switzerlandnorth\", \"switzerlandwest\", \"uksouth\", \"ukwest\"]);\nlet locMidEast = dynamic([\"qatarcentral\", \"uaecentral\", \"uaenorth\"]);\nlet locAfrica = dynamic([\"southafricanorth\", \"southafricawest\"]);\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| extend GroupRegion = iif(Region in (['locAustralia']), \"Australia\", iif(Region in (['locSouthAmerica']), \"South America\", iif(Region in (['locNorthAmerica']), \"North America\", iif(Region in (['locIndia']), \"India\", iif(Region in (['locAsia']), \"Asia\", iif(Region in (['locEurope']), \"Europe\", iif(Region in (['locMidEast']), \"MidEast\", iif(Region in (['locAfrica']), \"Africa\", iif(Region endswith \"euap\", \"EUAP\", \"Other\")))))))))\n| summarize LnxAgentCount = dcountif(AgentId, OSType == \"Linux\"), LnxResourceCount = dcountif(ResourceId, OSType == \"Linux\"),  LnxWorkspaceCount = dcountif(WorkspaceId, OSType == \"Linux\") by GroupRegion\n| sort by LnxAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":73,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"2c9c9e06-c994-4761-9763-daaf7abf52ee","title":"Agent Version Linux Population","query":"//AMA Pop by agent version\n//| where TIMESTAMP > ago(365d)\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA'])\n| where Name =~ \"microsoft.azure.monitor.azuremonitorlinuxagent\"\n| where OperationSuccess == true\n| where (Operation == \"Install\" or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\" or Operation == \"OnPluginEnableEnd\")\n| project\n    Version,\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId)\n    by Version\n| where TotalResourceCount > 0\n| sort by TotalResourceCount","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":11,"y":3,"width":11,"height":9},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"5c90aa52-cb95-4c7e-bd26-0b20cff6ff7a","title":"Windows Population Count","query":"//AMA for windows Installed or Enabled Count\n\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA'])\n| where Name =~ \"microsoft.azure.monitor.azuremonitorwindowsagent\"\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| where OperationSuccess == true\n| project\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":8,"y":0,"width":8,"height":3},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"cdf7e881-d6b2-4310-bdc8-e97024f7332a","title":"Linux Population Count","query":"//AMA for Linux  Installed or Enabled Count\n\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA'])\n| where Name =~ \"microsoft.azure.monitor.azuremonitorlinuxagent\"\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| where OperationSuccess == true\n| project\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":16,"y":0,"width":8,"height":3},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"88d81761-f0f3-44ae-baba-b2e19b47573f","title":"Top Region Linux Populations","query":"//AMA Linux Pop by region\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA'])\n| where Name =~ \"microsoft.azure.monitor.azuremonitorlinuxagent\"\n| where OperationSuccess == true\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| project\n    Region,\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId) by Region\n| where TotalResourceCount > 0\n| sort by TotalResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":11,"y":32,"width":11,"height":11},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"cf7a62eb-1d94-4d3b-a802-aec34d0e186f","title":"Grouped Region Linux Populations","query":"//AMA Linux Pop by region grouped\nlet locAustralia = dynamic([\"australiacentral\", \"australiacentral2\", \"australiaeast\", \"australiasoutheast\"]);\nlet locSouthAmerica = dynamic([\"brazilsouth\", \"brazilsoutheast\" ]);\nlet locNorthAmerica = dynamic([\"canadacentral\", \"canadaeast\", \"centralus\", \"eastus\", \"eastus2\", \"northcentralus\", \"southcentralus\", \"westcentralus\", \"westus\", \"westus2\", \"westus3\"]);\nlet locIndia = dynamic([\"centralindia\", \"jioindiacentral\", \"jioindiawest\", \"southindia\", \"westindia\"]);\nlet locAsia = dynamic([\"eastasia\", \"southeastasia\", \"japaneast\", \"japanwest\", \"koreacentral\", \"koreasouth\"]);\nlet locEurope = dynamic([\"francecentral\", \"francesouth\", \"germanynorth\", \"germanywestcentral\", \"northeurope\", \"westeurope\", \"norwayeast\", \"norwaywest\", \"swedencentral\", \"swedensouth\", \"switzerlandnorth\", \"switzerlandwest\", \"uksouth\", \"ukwest\"]);\nlet locMidEast = dynamic([\"qatarcentral\", \"uaecentral\", \"uaenorth\"]);\nlet locAfrica = dynamic([\"southafricanorth\", \"southafricawest\"]);\nlet locEUAP = dynamic([\"centraluseuap\", \"eastus2euap\"]);\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_AMA'] .. ['_endTime_AMA'])\n| where Name =~ \"microsoft.azure.monitor.azuremonitorlinuxagent\"\n| where OperationSuccess == true\n| where (Operation == \"Install\"  or Operation == \"Enable\" or Operation == \"OnPluginInstallEnd\"  or Operation == \"OnPluginEnableEnd\")\n| project\n    Region,\n    VMId\n|extend GroupRegion = iif(Region in (['locAustralia']), \"Australia\", iif(Region in (['locSouthAmerica']), \"South America\", iif(Region in (['locNorthAmerica']), \"North America\", iif(Region in (['locIndia']), \"India\", iif(Region in (['locAsia']), \"Asia\", iif(Region in (['locEurope']), \"Europe\", iif(Region in (['locMidEast']), \"MidEast\", iif(Region in (['locAfrica']), \"Africa\", iif(Region endswith \"euap\", \"EUAP\", \"Other\")))))))))\n| summarize\n    TotalResourceCount = dcount(VMId) by GroupRegion\n| where TotalResourceCount > 0\n| sort by TotalResourceCount","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":11,"y":43,"width":11,"height":10},"usedParamVariables":["_endTime_AMA","_startTime_AMA"],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"3a8241d1-9121-4a30-9022-f74b9be82341","title":"Arc/Non-Arc Linux Population","query":"//Linux Pop by Arc type\nHealthSummaryDaily\n| where StartTime > ago(90d)\n| where OSVer !has \"windows\"\n| project ResourceId\n| extend Arc = iif(ResourceId has \"/microsoft.HybridCompute/\", \"ARC\", \"NON-ARC\")\n| summarize totalResourceCount = dcount(ResourceId) by Arc\n| where totalResourceCount > 0\n| sort by totalResourceCount\n","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":11,"y":53,"width":11,"height":8},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"4ac9da0d-70d9-48e1-a8de-4e6a8659946b","title":"Windows Population Count","query":"//WAD Installed or Enabled Count\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD'])\n| where Name in~ ( \"microsoft.azure.diagnostics.iaasdiagnostics\",\"microsoft.azure.diagnostics.paasdiagnostics\",\"microsoft.azure.diagnostics.edp.iaasdiagnostics\",\"microsoft.azure.diagnostics.edp.paasdiagnostics\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| where OperationSuccess == true\n| project\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":8,"y":0,"width":8,"height":3},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"3c619bb5-8e20-4fb8-8584-1d7e661f7864","title":"Linux Population Count","query":"//LAD/WAD for Linux Installed or Enabled Count\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD'])\n| where OperationSuccess == true\n| where Name in~ (\"microsoft.azure.diagnostics.linuxdiagnostic\", \"microsoft.ostcextensions.linuxdiagnostic\",\"microsoft.ostcextensions.edp.linuxdiagnostic\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| project\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":16,"y":0,"width":8,"height":3},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"7a611d61-3535-468d-bb7f-2bafd5ccd863","title":"Agent Version Linux Population","query":"//LAD/WAD Linux Pop by agent version\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD'])\n| where OperationSuccess == true\n| where Name in~ (\"microsoft.azure.diagnostics.linuxdiagnostic\", \"microsoft.ostcextensions.linuxdiagnostic\",\"microsoft.ostcextensions.edp.linuxdiagnostic\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| project\n    Version,\n    VMId\n| summarize\n    TotalResourceCount = dcount(VMId) by Version\n| where TotalResourceCount > 0\n| sort by TotalResourceCount\n| take 32","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":12,"y":3,"width":12,"height":11},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"5b84c08f-fe18-408f-b2f9-56a8c05cd878","title":"Top Region Linux Populations","query":"//Current Linux pop by Region\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD']) // Time range filtering\n| where OperationSuccess == true\n| where Name in~ (\"microsoft.azure.diagnostics.linuxdiagnostic\", \"microsoft.ostcextensions.linuxdiagnostic\",\"microsoft.ostcextensions.edp.linuxdiagnostic\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| project\n    Region,\n    VMId\n| summarize\n    OSResourceCount = dcount(VMId)\n    by Region\n| where OSResourceCount > 0\n| sort by OSResourceCount\n| take 20","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":12,"y":33,"width":12,"height":11},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":true,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"e0caa21e-fbf2-4c7c-83cd-a26c6981f4f0","title":"Region Group Linux Populations","query":"//Current Linux pop by Grouped Region\nlet locAustralia = dynamic([\"australiacentral\", \"australiacentral2\", \"australiaeast\", \"australiasoutheast\"]);\nlet locSouthAmerica = dynamic([\"brazilsouth\", \"brazilsoutheast\" ]);\nlet locNorthAmerica = dynamic([\"canadacentral\", \"canadaeast\", \"centralus\", \"eastus\", \"eastus2\", \"northcentralus\", \"southcentralus\", \"westcentralus\", \"westus\", \"westus2\", \"westus3\"]);\nlet locIndia = dynamic([\"centralindia\", \"jioindiacentral\", \"jioindiawest\", \"southindia\", \"westindia\"]);\nlet locAsia = dynamic([\"eastasia\", \"southeastasia\", \"japaneast\", \"japanwest\", \"koreacentral\", \"koreasouth\"]);\nlet locEurope = dynamic([\"francecentral\", \"francesouth\", \"germanynorth\", \"germanywestcentral\", \"northeurope\", \"westeurope\", \"norwayeast\", \"norwaywest\", \"swedencentral\", \"swedensouth\", \"switzerlandnorth\", \"switzerlandwest\", \"uksouth\", \"ukwest\"]);\nlet locMidEast = dynamic([\"qatarcentral\", \"uaecentral\", \"uaenorth\"]);\nlet locAfrica = dynamic([\"southafricanorth\", \"southafricawest\"]);\ncluster('azcore.centralus.kusto.windows.net').database('Fa').\nGuestAgentExtensionEvents\n| where TIMESTAMP between (['_startTime_WAD'] .. ['_endTime_WAD']) // Time range filtering\n| where OperationSuccess == true\n| where Name in~ (\"microsoft.azure.diagnostics.linuxdiagnostic\", \"microsoft.ostcextensions.linuxdiagnostic\",\"microsoft.ostcextensions.edp.linuxdiagnostic\")\n| where Operation in ( \"Install\", \"Enable\", \"OnPluginInstallEnd\", \"OnPluginEnableEnd\")\n| project\n    Region,\n    VMId\n| extend GroupRegion = iif(Region in (['locAustralia']), \"Australia\", iif(Region in (['locSouthAmerica']), \"South America\", iif(Region in (['locNorthAmerica']), \"North America\", iif(Region in (['locIndia']), \"India\", iif(Region in (['locAsia']), \"Asia\", iif(Region in (['locEurope']), \"Europe\", iif(Region in (['locMidEast']), \"MidEast\", iif(Region in (['locAfrica']), \"Africa\", iif(Region endswith \"euap\", \"EUAP\", \"Other\")))))))))\n| summarize\n    ResourceCount = dcount(VMId)\n    by GroupRegion\n| where ResourceCount > 0\n| sort by ResourceCount","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"003c75ee-496b-47a4-be9b-f1e8d33b73da","layout":{"x":12,"y":44,"width":12,"height":11},"usedParamVariables":["_endTime_WAD","_startTime_WAD"],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"130ac994-4070-487a-9fc3-c3d2828dd1e8","title":"Solution/Extension Windows Population - 30d","query":"//Windows Pop by solution/extension\nHealthReport\n| where TIMESTAMP between (now(-30d) .. now())\n| where OSVer has \"windows\"\n| where _Ext has \"true\"\n| project _Ext, ResourceId\n| mv-expand _Ext to typeof(string)\n| where _Ext has \"true\"\n//| extend _Ext = replace_regex(_Ext, @'{\"(.*?)\".*', @'\\1')\n| summarize ResourceCount = dcount(ResourceId) by _Ext\n| sort by ResourceCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":0,"y":61,"width":22,"height":11},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"ee838060-af57-441e-a189-671169ff9f9c","title":"Solution/Extension Linux Population - 45d","query":"//Linux Pop by solution/extension\nHealthReport\n| where TIMESTAMP between (now(-45d) .. now())\n| where OSVer !has \"windows\"\n| where _Ext has \"true\"\n| project _Ext, ResourceId\n| mv-expand _Ext to typeof(string)\n| where _Ext has \"true\"\n//| extend _Ext = replace_regex(_Ext, @'{\"(.*?)\".*', @'\\1')\n| summarize ResourceCount = dcount(ResourceId) by _Ext\n| sort by ResourceCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","layout":{"x":0,"y":72,"width":22,"height":11},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage","value"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}},{"id":"e2a44ec0-67b8-4e4e-b642-ddb0f283d391","title":"Azure vs On-prem vs. Arc","query":"//Azure vs On-prem vs. Arc\nlet Linux = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot) | extend OSType = \"Linux\";\nlet Windows = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot) | extend OSType = \"Windows\";\nunion Linux, Windows\n| summarize Azure = countif(Region != \"onpremise\" and ResourceId !has \"microsoft.hybridcompute\"),\n            Direct = countif(Region == \"onpremise\" and isempty(ResourceId)),\n            Arc = countif(ResourceId has \"microsoft.hybridcompute\")\n            by OSType","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"bar","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":53,"width":24,"height":7},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"596b4c2d-9791-40cf-8b49-434b0e548ac8","title":"OMS Linux Population Trend","query":"//OMS Linux Population Trend\n\nunion (cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshotOld | where Date < datetime(2020-06-28)), cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot\n| summarize DailyCount = count() by Date\n| summarize MonthlyMax = max(DailyCount) by endofmonth(Date)\n| render timechart","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"line","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":6,"width":12,"height":9},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"ff3dc625-a82d-4219-871a-3606dad1f516","title":"OMS Windows Population Trend","query":"//OMS Windows Population Trend\n\ncluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot\n| summarize DailyCount = count() by Date\n| summarize MonthlyMax = max(DailyCount) by endofmonth(Date)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"line","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":6,"width":12,"height":9},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"f7a44e9a-9534-4928-991c-03c32befdede","title":"Windows Snapshot Max Count","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot\n| where Date > now(-30d)\n| summarize count() by Date\n| summarize Population = max(count_)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":8,"y":3,"width":8,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"47225f8a-aa29-4615-820c-0221a411a52c","title":"Linux Snapshot Max Count","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot\n| where Date > now(-30d)\n| summarize count() by Date\n| summarize Population = max(count_)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":16,"y":3,"width":8,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"0a180b29-d9ff-4123-aaf6-2d15a01cf956","title":"Total Snapshot Max Count","query":"union cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot, cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot\n| where Date > now(-30d)\n| summarize count() by Date\n| summarize Population = max(count_)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":3,"width":8,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"f83e742d-2daf-4271-b114-a54f4c2f28a9","title":"Top 50 customers of OMS based off agent count","query":"//Top customers OMS by AgentId Count\n\nlet WorkspaceOS = union\n        Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot),\n        Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n    | extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n    | summarize\n        HasWindows = countif(OSType == \"Windows\") > 0,\n        HasLinux = countif(OSType == \"Linux\") > 0\n        by WorkspaceId;\nunion\n    Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot),\n    Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| extend CustomerId = tostring(split(ResourceId, \"/\")[2])\n| where CustomerId != \"\"\n| summarize\n    TotalAgentCount = dcount(AgentId),\n    WinAgentCount = dcountif(AgentId, OSType == \"Windows\"),\n    LnxAgentCount = dcountif(AgentId, OSType == \"Linux\") by CustomerId\n| sort by TotalAgentCount desc\n| take 50","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"table","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":114,"width":17,"height":12},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}}],"dataSources":[{"id":"81c7dec3-36d3-46ff-96fc-9751a73cae68","name":"geneva agent","clusterUri":"https://genevaagent.kusto.windows.net/","database":"AMA","kind":"manual-kusto","scopeId":"kusto"}],"schema_version":"24","autoRefresh":{"enabled":false},"parameters":[{"kind":"string","id":"27de3776-7a20-4852-95e8-8502e038aad0","displayName":"OS - AMA","variableName":"_OSselected_AMA","selectionType":"multi","defaultValue":{"kind":"values","values":["microsoft.azure.monitor.azuremonitorwindowsagent","microsoft.azure.monitor.azuremonitorlinuxagent"]},"dataSource":{"kind":"static","values":[{"value":"microsoft.azure.monitor.azuremonitorwindowsagent","displayText":"Windows"},{"value":"microsoft.azure.monitor.azuremonitorlinuxagent","displayText":"Linux"}]},"showOnPages":{"kind":"selection","pageIds":[]}},{"kind":"duration","id":"7590c37e-3b0e-4edd-a0fe-99a2d2860025","displayName":"Time range - AMA","beginVariableName":"_startTime_AMA","endVariableName":"_endTime_AMA","defaultValue":{"kind":"dynamic","count":90,"unit":"days"},"showOnPages":{"kind":"selection","pageIds":["fd0b8463-65c9-485f-92d9-4b63454e4ff0"]}},{"kind":"string","id":"ffed3989-ec4d-480c-978a-a3045769c7f5","displayName":"OS - OMS","variableName":"_OSselected_OMS","selectionType":"multi","defaultValue":{"kind":"values","values":["microsoft.enterprisecloud.monitoring.microsoftmonitoringagent","microsoft.enterprisecloud.monitoring.omsagentforlinux"]},"dataSource":{"kind":"static","values":[{"value":"microsoft.enterprisecloud.monitoring.microsoftmonitoringagent","displayText":"Windows"},{"value":"microsoft.enterprisecloud.monitoring.omsagentforlinux","displayText":"Linux"}]},"showOnPages":{"kind":"selection","pageIds":[]}},{"kind":"duration","id":"769f73da-ecf8-4319-8c09-861cec13b05d","displayName":"Time range - OMS","beginVariableName":"_startTime_OMS","endVariableName":"_endTime_OMS","defaultValue":{"kind":"dynamic","count":1,"unit":"hours"},"showOnPages":{"kind":"selection","pageIds":[]}},{"kind":"string","id":"1753ee45-bd68-48de-8066-c0666055d14e","displayName":"OS - LAD/WAD","variableName":"_OSselected_WAD","selectionType":"multi","defaultValue":{"kind":"values","values":["windows","linux"]},"dataSource":{"kind":"static","values":[{"value":"windows","displayText":"Windows"},{"value":"linux","displayText":"Linux"}]},"showOnPages":{"kind":"selection","pageIds":[]}},{"kind":"duration","id":"0f278835-9336-447f-9aa3-87144c7ed004","displayName":"Time Range - LAD/WAD","beginVariableName":"_startTime_WAD","endVariableName":"_endTime_WAD","defaultValue":{"kind":"dynamic","count":90,"unit":"days"},"showOnPages":{"kind":"selection","pageIds":["003c75ee-496b-47a4-be9b-f1e8d33b73da"]}},{"kind":"duration","id":"87c3dc17-2c30-4cdd-8c69-4fd7b985be58","displayName":"Time range - Solutions","beginVariableName":"_startTime_Sol","endVariableName":"_endTime_Sol","defaultValue":{"kind":"dynamic","count":24,"unit":"hours"},"showOnPages":{"kind":"selection","pageIds":["08535203-ea49-4249-a162-ba3bfeb07493"]}},{"kind":"duration","id":"59d49e78-b480-4ae1-8851-864083461a34","displayName":"Time range - Arc","beginVariableName":"_startTime_Arc","endVariableName":"_endTime_Arc","defaultValue":{"kind":"dynamic","count":2,"unit":"days"},"showOnPages":{"kind":"selection","pageIds":["dc94e171-3a9a-47ff-af6b-d987d7e4ecc6"]}}],"pages":[{"id":"fd0b8463-65c9-485f-92d9-4b63454e4ff0","name":"AMA"},{"name":"OMS","id":"9db0948a-e66b-437f-a1a8-a5a0921776c9"},{"id":"003c75ee-496b-47a4-be9b-f1e8d33b73da","name":"LAD/WAD"}]}