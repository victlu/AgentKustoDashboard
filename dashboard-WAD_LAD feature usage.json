{"$schema":"https://dataexplorer.azure.com/static/d/schema/24/dashboard.json","id":"4329f38d-31eb-44bf-9427-2b4a620a6936","eTag":"4329f38d-31eb-44bf-9427-2b4a620a6936","schema_version":"24","title":"WAD/LAD feature usage","autoRefresh":{"enabled":false},"tiles":[{"id":"8a90a4e4-4890-4f50-9b75-78058c5f3d58","title":"WAD Usage 1-Week","query":"let FiveDayPUT_Iaas = cluster('azcrp.kusto.windows.net').database('crp_allprod').ApiQosEvent \n| where TIMESTAMP between (ago(7d) .. ago(1h))\n| where operationName == \"VMExtensions.VMExtensionOperation.PUT\" \n| where isnotempty(requestEntity) \n| extend requestEntityJS = parse_json(requestEntity) \n| where requestEntityJS.properties.type contains \"IaaSDiagnostics\"\n| extend WadConfig = iff(isempty(requestEntityJS.properties.settings.WadCfg), parse_xml(base64_decode_tostring(tostring(requestEntityJS.properties.settings.xmlCfg))).WadCfg, requestEntityJS.properties.settings.WadCfg) \n;\nlet FiveDayPUTIaaS = materialize(FiveDayPUT_Iaas);\nlet Usage_WindowsEventLogs = FiveDayPUTIaaS\n| extend HasWindowsEventLogs = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.WindowsEventLog), 0, 1)\n| summarize Category = \"WindowsEventLogs\", Usage=round(sum(HasWindowsEventLogs) * 100.0 / count(),3);\nlet Usage_Metrics = FiveDayPUTIaaS\n| extend HasMetrics = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.Metrics), 0, 1) \n| summarize Category = \"Metrics\", Usage=round(sum(HasMetrics) * 100.0 / count(),2);\nlet Usage_Performance = FiveDayPUTIaaS\n| extend HasPerformanceCounters = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.PerformanceCounters), 0, 1)  \n| summarize Category = \"Performance\", Usage=round(sum(HasPerformanceCounters) * 100.0 / count(),3);\nlet Usage_CrashDumps = FiveDayPUTIaaS\n| extend HasCrashDumps = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.CrashDumps), 0, 1)  \n| summarize Category = \"CrashDumps\", Usage=round(sum(HasCrashDumps) * 100.0 / count(),2);\nlet Usage_EtwProviders = FiveDayPUTIaaS\n| extend HasEtwProviders = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.EtwProviders), 0, 1)  \n| summarize Category = \"EtwProviders\", Usage=round(sum(HasEtwProviders) * 100.0 / count(),2);\nlet Usage_Directories = FiveDayPUTIaaS\n| extend HasDirectories = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.Directories), 0, 1)  \n| summarize Category = \"Directories\", Usage=round(sum(HasDirectories) * 100.0 / count(),2);\nlet Usage_Logs = FiveDayPUTIaaS\n| extend HasLogs = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.Logs), 0, 1) \n| summarize Category = \"Logs\", Usage=round(sum(HasLogs) * 100.0 / count(),3);\nlet Usage_DockerSources = FiveDayPUTIaaS\n| extend HasDockerSources = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.DockerSources), 0, 1)  \n| summarize Category = \"DockerSources\", Usage=round(sum(HasDockerSources) * 100.0 / count(),2);\nlet Usage_DiagnosticInfrastructureLogs = FiveDayPUTIaaS\n| extend HasDiagnosticInfrastructureLogs = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.DiagnosticInfrastructureLogs), 0, 1)   \n| summarize Category = \"DiagnosticInfrastructureLogs\", Usage=round(sum(HasDiagnosticInfrastructureLogs) * 100.0 / count(),3);\nlet Usage_BlobStorage = FiveDayPUTIaaS\n| extend HasBlobStorage = iff(isempty(requestEntityJS.properties.settings.StorageType), 0, iff(indexof(requestEntityJS.properties.settings.StorageType, \"Blob\") >= 0, 1, 0))\n| summarize Category = \"BlobStorage\", Usage=round(sum(HasBlobStorage) * 100.0 / count(),2);\nlet Usage_TableStorage = FiveDayPUTIaaS\n| extend HasTableStorage = iff(isempty(requestEntityJS.properties.settings.StorageType), 1, iff(indexof(requestEntityJS.properties.settings.StorageType, \"Table\") >= 0, 1, 0))\n| summarize Category = \"TableStorage\", Usage=round(sum(HasTableStorage) * 100.0 / count(),2);\nlet FiveDayPUTIaaS_SinkExpand = \nFiveDayPUTIaaS\n| mv-apply WadConfig.SinksConfig.Sink on ( \n    mv-expand with_itemindex=Index WadConfig.SinksConfig.Sink \n    | extend HasEventHub = iif(isempty(WadConfig.SinksConfig.Sink[Index].EventHub), 0, 1) \n    | extend HasAppInsights = iif(isempty(WadConfig.SinksConfig.Sink[Index].ApplicationInsights), 0, 1) \n    | summarize EventHubCount = sum(HasEventHub), AICount = sum(HasAppInsights) \n    ) ;\nlet Usage_EventHub = FiveDayPUTIaaS_SinkExpand\n| extend HasEventHub = iif(EventHubCount > 0, 1, 0) \n| summarize Category = \"EventHub\", Usage=round(sum(HasEventHub) * 100.0 / count(),2);\nlet Usage_AppInsights = FiveDayPUTIaaS_SinkExpand\n| extend HasAppInsight = iif(AICount > 0, 1, 0)\n| summarize Category = \"AppInsights\", Usage=round(sum(HasAppInsight) * 100.0 / count(),2);\nunion Usage_WindowsEventLogs, \n      Usage_Performance,\n      Usage_Metrics,\n      Usage_CrashDumps,\n      Usage_EtwProviders,\n      Usage_Directories,\n      Usage_Logs,\n      Usage_DockerSources,\n      Usage_DiagnosticInfrastructureLogs,\n      Usage_BlobStorage,\n      Usage_TableStorage,\n      Usage_EventHub,\n      Usage_AppInsights\n| sort by Usage","dataSourceId":"fb6da167-8074-4198-8402-5d665e70c60a","visualType":"bar","pageId":"ddc1a595-96ec-4f53-a1c8-e8ae397f23bf","layout":{"x":0,"y":0,"width":23,"height":11},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Percent Usage","columns":[],"yAxisMaximumValue":100,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":true,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"af7c0372-ce41-4198-85b6-dd3a0ab77f72","title":"WAD ResourceName Count","query":"cluster('azcrp.kusto.windows.net').database('crp_allprod').ApiQosEvent \n| where TIMESTAMP > ago(5d) \n| where operationName == \"VMExtensions.VMExtensionOperation.PUT\" \n| where isnotempty(requestEntity) \n| extend requestEntityJS = parse_json(requestEntity) \n| where requestEntityJS.properties.type contains \"IaaSDiagnostics\" \n| summarize resourceCount = dcount(resourceName)\n","dataSourceId":"fb6da167-8074-4198-8402-5d665e70c60a","visualType":"card","pageId":"ddc1a595-96ec-4f53-a1c8-e8ae397f23bf","layout":{"x":0,"y":20,"width":6,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"115aaf0c-b722-44bd-9f0f-ab44bd15c1d6","title":"WAD Usage","query":"let FiveDayPUT_Iaas = cluster('azcrp.kusto.windows.net').database('crp_allprod').ApiQosEvent \n| where TIMESTAMP > ago(5d) \n| where operationName == \"VMExtensions.VMExtensionOperation.PUT\" \n| where isnotempty(requestEntity) \n| extend requestEntityJS = parse_json(requestEntity) \n| where requestEntityJS.properties.type contains \"IaaSDiagnostics\"\n| extend WadConfig = iff(isempty(requestEntityJS.properties.settings.WadCfg), parse_xml(base64_decode_tostring(tostring(requestEntityJS.properties.settings.xmlCfg))).WadCfg, requestEntityJS.properties.settings.WadCfg) \n;\nlet FiveDayPUTIaaS = materialize(FiveDayPUT_Iaas);\nlet Usage_WindowsEventLogs = FiveDayPUTIaaS\n| extend HasWindowsEventLogs = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.WindowsEventLog), 0, 1)\n| summarize Category = \"WindowsEventLogs\", Usage=round(sum(HasWindowsEventLogs) * 100.0 / count(),2);\nlet Usage_Metrics = FiveDayPUTIaaS\n| extend HasMetrics = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.Metrics), 0, 1) \n| summarize Category = \"Metrics\", Usage=round(sum(HasMetrics) * 100.0 / count(),2);\nlet Usage_Performance = FiveDayPUTIaaS\n| extend HasPerformanceCounters = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.PerformanceCounters), 0, 1)  \n| summarize Category = \"Performance\", Usage=round(sum(HasPerformanceCounters) * 100.0 / count(),2);\nlet Usage_CrashDumps = FiveDayPUTIaaS\n| extend HasCrashDumps = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.CrashDumps), 0, 1)  \n| summarize Category = \"CrashDumps\", Usage=round(sum(HasCrashDumps) * 100.0 / count(),2);\nlet Usage_EtwProviders = FiveDayPUTIaaS\n| extend HasEtwProviders = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.EtwProviders), 0, 1)  \n| summarize Category = \"EtwProviders\", Usage=round(sum(HasEtwProviders) * 100.0 / count(),2);\nlet Usage_Directories = FiveDayPUTIaaS\n| extend HasDirectories = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.Directories), 0, 1)  \n| summarize Category = \"Directories\", Usage=round(sum(HasDirectories) * 100.0 / count(),2);\nlet Usage_Logs = FiveDayPUTIaaS\n| extend HasLogs = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.Logs), 0, 1) \n| summarize Category = \"Logs\", Usage=round(sum(HasLogs) * 100.0 / count(),2);\nlet Usage_DockerSources = FiveDayPUTIaaS\n| extend HasDockerSources = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.DockerSources), 0, 1)  \n| summarize Category = \"DockerSources\", Usage=round(sum(HasDockerSources) * 100.0 / count(),2);\nlet Usage_DiagnosticInfrastructureLogs = FiveDayPUTIaaS\n| extend HasDiagnosticInfrastructureLogs = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.DiagnosticInfrastructureLogs), 0, 1)   \n| summarize Category = \"DiagnosticInfrastructureLogs\", Usage=round(sum(HasDiagnosticInfrastructureLogs) * 100.0 / count(),2);\nlet Usage_BlobStorage = FiveDayPUTIaaS\n| extend HasBlobStorage = iff(isempty(requestEntityJS.properties.settings.StorageType), 0, iff(indexof(requestEntityJS.properties.settings.StorageType, \"Blob\") >= 0, 1, 0))\n| summarize Category = \"BlobStorage\", Usage=round(sum(HasBlobStorage) * 100.0 / count(),2);\nlet Usage_TableStorage = FiveDayPUTIaaS\n| extend HasTableStorage = iff(isempty(requestEntityJS.properties.settings.StorageType), 1, iff(indexof(requestEntityJS.properties.settings.StorageType, \"Table\") >= 0, 1, 0))\n| summarize Category = \"TableStorage\", Usage=round(sum(HasTableStorage) * 100.0 / count(),2);\nlet FiveDayPUTIaaS_SinkExpand = \nFiveDayPUTIaaS\n| mv-apply WadConfig.SinksConfig.Sink on ( \n    mv-expand with_itemindex=Index WadConfig.SinksConfig.Sink \n    | extend HasEventHub = iif(isempty(WadConfig.SinksConfig.Sink[Index].EventHub), 0, 1) \n    | extend HasAppInsights = iif(isempty(WadConfig.SinksConfig.Sink[Index].ApplicationInsights), 0, 1) \n    | summarize EventHubCount = sum(HasEventHub), AICount = sum(HasAppInsights) \n    ) ;\nlet Usage_EventHub = FiveDayPUTIaaS_SinkExpand\n| extend HasEventHub = iif(EventHubCount > 0, 1, 0) \n| summarize Category = \"EventHub\", Usage=round(sum(HasEventHub) * 100.0 / count(),2);\nlet Usage_AppInsights = FiveDayPUTIaaS_SinkExpand\n| extend HasAppInsight = iif(AICount > 0, 1, 0)\n| summarize Category = \"AppInsights\", Usage=round(sum(HasAppInsight) * 100.0 / count(),2);\nunion Usage_WindowsEventLogs, \n      Usage_Performance,\n      Usage_Metrics,\n      Usage_CrashDumps,\n      Usage_EtwProviders,\n      Usage_Directories,\n      Usage_Logs,\n      Usage_DockerSources,\n      Usage_DiagnosticInfrastructureLogs,\n      Usage_BlobStorage,\n      Usage_TableStorage,\n      Usage_EventHub,\n      Usage_AppInsights\n| sort by Usage","dataSourceId":"fb6da167-8074-4198-8402-5d665e70c60a","visualType":"multistat","pageId":"ddc1a595-96ec-4f53-a1c8-e8ae397f23bf","layout":{"x":0,"y":11,"width":23,"height":9},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light","multiStat__displayOrientation":"horizontal","multiStat__labelColumn":{"type":"infer"},"multiStat__slot":{"width":5,"height":3}}},{"id":"ec253177-5dd0-4586-a320-46db7233b9cf","title":"LAD Usage","query":"let FiveDayPUT_Iaas = cluster('azcrp.kusto.windows.net').database('crp_allprod').ApiQosEvent\n| where TIMESTAMP > ago(5d) \n| where operationName == \"VMExtensions.VMExtensionOperation.PUT\" \n| where isnotempty(requestEntity) \n| extend requestEntityJS = parse_json(requestEntity) \n| where requestEntityJS.properties.type contains \"IaaSDiagnostics\" ;\nlet FiveDayPUTIaaS = materialize(FiveDayPUT_Iaas);\nlet Usage_SysLogs = FiveDayPUTIaaS\n| extend HasSyslogs = iff(requestEntity has \"syslogEvents\", 1, 0) \n| summarize Category = \"SysLogs\", Usage=round(sum(HasSyslogs) * 100.0 / count(),2);\nlet Usage_Metrics = FiveDayPUTIaaS\n| extend HasMetrics = iff(requestEntity has \"metrics\", 1, 0) \n| summarize Category = \"Metrics\", Usage=round(sum(HasMetrics) * 100.0 / count(),2);\nlet Usage_PerformanceCounters = FiveDayPUTIaaS\n| extend HasPerformanceCounters = iff(requestEntity has \"performanceCounters\", 1, 0) \n| summarize Category = \"PerformanceCounters\", Usage=round(sum(HasPerformanceCounters) * 100.0 / count(),2);\nlet Usage_FileLogs = FiveDayPUTIaaS\n| extend HasLogs = iff(requestEntity has \"fileLogs\", 1, 0) \n| summarize Category = \"FileLogs\", Usage=round(sum(HasLogs) * 100.0 / count(),2);\nlet Usage_BlobStorage = FiveDayPUTIaaS\n| extend HasBlobStorage = iff(requestEntity has \"JsonBlob\", 1, 0) \n| summarize Category = \"BlobStorage\", Usage=round(sum(HasBlobStorage) * 100.0 / count(),2);\nlet Usage_TableStorage = FiveDayPUTIaaS\n| extend HasTableStorage = iff(requestEntity has \"StorageAccount\", 1, 0)\n| summarize Category = \"TableStorage\", Usage=round(sum(HasTableStorage) * 100.0 / count(),2);\nlet Usage_EventHub = FiveDayPUTIaaS\n| extend HasEventHub = iff(requestEntity has \"EventHub\", 1, 0)\n| summarize Category = \"EventHub\", Usage=round(sum(HasEventHub) * 100.0 / count(),2);\nunion Usage_SysLogs, \n      Usage_Metrics,\n      Usage_PerformanceCounters,\n      Usage_FileLogs,\n      Usage_BlobStorage,\n      Usage_TableStorage,\n      Usage_EventHub\n| sort by Usage","dataSourceId":"fb6da167-8074-4198-8402-5d665e70c60a","visualType":"bar","pageId":"8d744582-1907-4072-9b20-3712e90f9e7b","layout":{"x":0,"y":0,"width":23,"height":8},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Percent Usage","columns":[],"yAxisMaximumValue":100,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":true,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"118976a3-c2a6-42db-a2ac-fec4b79edf4f","title":"LAD Usage","query":"let FiveDayPUT_Iaas = cluster('azcrp.kusto.windows.net').database('crp_allprod').ApiQosEvent\n| where TIMESTAMP > ago(5d) \n| where operationName == \"VMExtensions.VMExtensionOperation.PUT\" \n| where isnotempty(requestEntity) \n| extend requestEntityJS = parse_json(requestEntity) \n| where requestEntityJS.properties.type contains \"IaaSDiagnostics\" ;\nlet FiveDayPUTIaaS = materialize(FiveDayPUT_Iaas);\nlet Usage_SysLogs = FiveDayPUTIaaS\n| extend HasSyslogs = iff(requestEntity has \"syslogEvents\", 1, 0) \n| summarize Category = \"SysLogs\", Usage=round(sum(HasSyslogs) * 100.0 / count(),2);\nlet Usage_Metrics = FiveDayPUTIaaS\n| extend HasMetrics = iff(requestEntity has \"metrics\", 1, 0) \n| summarize Category = \"Metrics\", Usage=round(sum(HasMetrics) * 100.0 / count(),2);\nlet Usage_PerformanceCounters = FiveDayPUTIaaS\n| extend HasPerformanceCounters = iff(requestEntity has \"performanceCounters\", 1, 0) \n| summarize Category = \"PerformanceCounters\", Usage=round(sum(HasPerformanceCounters) * 100.0 / count(),2);\nlet Usage_FileLogs = FiveDayPUTIaaS\n| extend HasLogs = iff(requestEntity has \"fileLogs\", 1, 0) \n| summarize Category = \"FileLogs\", Usage=round(sum(HasLogs) * 100.0 / count(),2);\nlet Usage_BlobStorage = FiveDayPUTIaaS\n| extend HasBlobStorage = iff(requestEntity has \"JsonBlob\", 1, 0) \n| summarize Category = \"BlobStorage\", Usage=round(sum(HasBlobStorage) * 100.0 / count(),2);\nlet Usage_TableStorage = FiveDayPUTIaaS\n| extend HasTableStorage = iff(requestEntity has \"StorageAccount\", 1, 0)\n| summarize Category = \"TableStorage\", Usage=round(sum(HasTableStorage) * 100.0 / count(),2);\nlet Usage_EventHub = FiveDayPUTIaaS\n| extend HasEventHub = iff(requestEntity has \"EventHub\", 1, 0)\n| summarize Category = \"EventHub\", Usage=round(sum(HasEventHub) * 100.0 / count(),2);\nunion Usage_SysLogs, \n      Usage_Metrics,\n      Usage_PerformanceCounters,\n      Usage_FileLogs,\n      Usage_BlobStorage,\n      Usage_TableStorage,\n      Usage_EventHub\n| sort by Usage","dataSourceId":"fb6da167-8074-4198-8402-5d665e70c60a","visualType":"multistat","pageId":"8d744582-1907-4072-9b20-3712e90f9e7b","layout":{"x":0,"y":8,"width":23,"height":6},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light","multiStat__displayOrientation":"horizontal","multiStat__labelColumn":{"type":"infer"},"multiStat__slot":{"width":4,"height":2}}},{"id":"17530688-56eb-415d-9966-d12e9aeda576","title":"WAD Count Usage","query":"let FiveDayPUT_Iaas = cluster('azcrp.kusto.windows.net').database('crp_allprod').ApiQosEvent \n| where TIMESTAMP > ago(5d) \n| where operationName == \"VMExtensions.VMExtensionOperation.PUT\" \n| where isnotempty(requestEntity) \n| extend requestEntityJS = parse_json(requestEntity) \n| where requestEntityJS.properties.type contains \"IaaSDiagnostics\"\n| extend WadConfig = iff(isempty(requestEntityJS.properties.settings.WadCfg), parse_xml(base64_decode_tostring(tostring(requestEntityJS.properties.settings.xmlCfg))).WadCfg, requestEntityJS.properties.settings.WadCfg) \n;\nlet FiveDayPUTIaaS = materialize(FiveDayPUT_Iaas);\nlet ResCnt_WindowsEventLogs = FiveDayPUTIaaS\n| extend HasWindowsEventLogs = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.WindowsEventLog), 0, 1)\n| summarize Category = \"WindowsEventLogs\", ResCount=dcountif(resourceName, HasWindowsEventLogs==1);\nlet ResCnt_Metrics = FiveDayPUTIaaS\n| extend HasMetrics = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.Metrics), 0, 1) \n| summarize Category = \"Metrics\", ResCount=dcountif(resourceName, HasMetrics==1);\nlet ResCnt_Performance = FiveDayPUTIaaS\n| extend HasPerformanceCounters = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.PerformanceCounters), 0, 1)  \n| summarize Category = \"Performance\", ResCount=dcountif(resourceName, HasPerformanceCounters==1);\nlet ResCnt_CrashDumps = FiveDayPUTIaaS\n| extend HasCrashDumps = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.CrashDumps), 0, 1)  \n| summarize Category = \"CrashDumps\", ResCount=dcountif(resourceName, HasCrashDumps==1);\nlet ResCnt_EtwProviders = FiveDayPUTIaaS\n| extend HasEtwProviders = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.EtwProviders), 0, 1)  \n| summarize Category = \"EtwProviders\", ResCount=dcountif(resourceName, HasEtwProviders==1);\nlet ResCnt_Directories = FiveDayPUTIaaS\n| extend HasDirectories = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.Directories), 0, 1)  \n| summarize Category = \"Directories\", ResCount=dcountif(resourceName, HasDirectories==1);\nlet ResCnt_Logs = FiveDayPUTIaaS\n| extend HasLogs = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.Logs), 0, 1) \n| summarize Category = \"Logs\", ResCount=dcountif(resourceName, HasLogs==1);\nlet ResCnt_DockerSources = FiveDayPUTIaaS\n| extend HasDockerSources = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.DockerSources), 0, 1)  \n| summarize Category = \"DockerSources\", ResCount=dcountif(resourceName, HasDockerSources==1);\nlet ResCnt_DiagnosticInfrastructureLogs = FiveDayPUTIaaS\n| extend HasDiagnosticInfrastructureLogs = iff(isempty(WadConfig.DiagnosticMonitorConfiguration.DiagnosticInfrastructureLogs), 0, 1)   \n| summarize Category = \"DiagnosticInfrastructureLogs\", ResCount=dcountif(resourceName, HasDiagnosticInfrastructureLogs==1);\nlet ResCnt_BlobStorage = FiveDayPUTIaaS\n| extend HasBlobStorage = iff(isempty(requestEntityJS.properties.settings.StorageType), 0, iff(indexof(requestEntityJS.properties.settings.StorageType, \"Blob\") >= 0, 1, 0))\n| summarize Category = \"BlobStorage\", ResCount=dcountif(resourceName, HasBlobStorage==1);\nlet ResCnt_TableStorage = FiveDayPUTIaaS\n| extend HasTableStorage = iff(isempty(requestEntityJS.properties.settings.StorageType), 1, iff(indexof(requestEntityJS.properties.settings.StorageType, \"Table\") >= 0, 1, 0))\n| summarize Category = \"TableStorage\", ResCount=dcountif(resourceName, HasTableStorage==1);\nlet FiveDayPUTIaaS_SinkExpand = \nFiveDayPUTIaaS\n| mv-apply WadConfig.SinksConfig.Sink on ( \n    mv-expand with_itemindex=Index WadConfig.SinksConfig.Sink \n    | extend HasEventHub = iif(isempty(WadConfig.SinksConfig.Sink[Index].EventHub), 0, 1) \n    | extend HasAppInsights = iif(isempty(WadConfig.SinksConfig.Sink[Index].ApplicationInsights), 0, 1) \n    | summarize EventHubCount = sum(HasEventHub), AICount = sum(HasAppInsights) \n    ) ;\nlet ResCnt_EventHub = FiveDayPUTIaaS_SinkExpand\n| extend HasEventHub = iif(EventHubCount > 0, 1, 0) \n| summarize Category = \"EventHub\", ResCount=dcountif(resourceName, HasEventHub==1);\nlet ResCnt_AppInsights = FiveDayPUTIaaS_SinkExpand\n| extend HasAppInsight = iif(AICount > 0, 1, 0)\n| summarize Category = \"AppInsights\", ResCount=dcountif(resourceName, HasAppInsight==1);\nunion ResCnt_WindowsEventLogs, \n      ResCnt_Performance,\n      ResCnt_Metrics,\n      ResCnt_CrashDumps,\n      ResCnt_EtwProviders,\n      ResCnt_Directories,\n      ResCnt_Logs,\n      ResCnt_DockerSources,\n      ResCnt_DiagnosticInfrastructureLogs,\n      ResCnt_BlobStorage,\n      ResCnt_TableStorage,\n      ResCnt_EventHub,\n      ResCnt_AppInsights\n| sort by ResCount\n","dataSourceId":"fb6da167-8074-4198-8402-5d665e70c60a","visualType":"bar","pageId":"ddc1a595-96ec-4f53-a1c8-e8ae397f23bf","layout":{"x":0,"y":23,"width":23,"height":11},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Distinct Resource Cnt","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":true,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"e115d850-d96e-4bdc-b77c-9afc0fc45a32","title":"WAD Avg Weekly % Usage Trend","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').WADUsageManSnapshot\n| project Date, Category, Usage\n| summarize AvgUsage = round(avg(Usage),2) by Category, week = startofmonth(Date)\n| project-reorder week, Category, AvgUsage\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"timechart","pageId":"6e437167-fc29-49a3-ad23-a3aa4247eb6c","layout":{"x":0,"y":0,"width":23,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Percent Usage","columns":[],"yAxisMaximumValue":100,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"715d563d-7775-4594-b3ac-e3982d0357dc","title":"WAD Avg Percent Usage Past Month","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').WADUsageManSnapshot\n| where Date > ago(31d)\n| project Date, Category, Usage\n| summarize AvgUsage = round(avg(Usage),2) by Category\n| project-reorder Category, AvgUsage\n| sort by AvgUsage\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"bar","pageId":"6e437167-fc29-49a3-ad23-a3aa4247eb6c","layout":{"x":0,"y":26,"width":23,"height":11},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Percent Usage","columns":[],"yAxisMaximumValue":100,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":true,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"771a6c3e-fc7b-41f7-b400-a0b8a2933985","title":"WAD Avg Resource Count Past Month","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').WADUsageManSnapshot\n| where Date > ago(31d)\n| project Date, Category, ResCount\n| summarize AvgResCount = round(avg(ResCount),2) by Category\n| project-reorder Category, AvgResCount\n| sort by AvgResCount\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"bar","pageId":"6e437167-fc29-49a3-ad23-a3aa4247eb6c","layout":{"x":0,"y":46,"width":23,"height":11},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Percent Usage","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":true,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"f1502e25-7368-434a-b4e7-7b87628e9f5c","title":"WAD Avg Weekly Resource Count Trend","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').WADUsageManSnapshot\n| project Date, Category, ResCount\n| summarize AvgResCount = round(avg(ResCount),0) by Category, week = startofmonth(Date)\n| project-reorder week, Category, AvgResCount\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"timechart","pageId":"6e437167-fc29-49a3-ad23-a3aa4247eb6c","layout":{"x":0,"y":13,"width":23,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"09ecebcd-c6e5-49a8-bdb6-8a144adf255e","title":"WAD Avg Percent Usage Past Month","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').WADUsageManSnapshot\n| where Date > ago(31d)\n| project Date, Category, Usage\n| summarize AvgUsage = round(avg(Usage),2) by Category\n| project-reorder Category, AvgUsage\n| sort by AvgUsage\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"multistat","pageId":"6e437167-fc29-49a3-ad23-a3aa4247eb6c","layout":{"x":0,"y":37,"width":23,"height":9},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light","multiStat__displayOrientation":"horizontal","multiStat__labelColumn":{"type":"infer"},"multiStat__slot":{"width":5,"height":3}}},{"id":"d8a6e8cd-81ef-47b6-b56f-86a052561bd4","title":"LAD Avg Weekly % Usage Trend","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').LADUsageManSnapshot\n| project Date, Category, Usage\n| summarize AvgUsage = round(avg(Usage),2) by Category, week = startofmonth(Date)\n| project-reorder week, Category, AvgUsage\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"timechart","pageId":"1832124b-0c43-4edf-a1ab-59a9cda49210","layout":{"x":0,"y":0,"width":23,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Percent Usage","columns":[],"yAxisMaximumValue":100,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"fbe0cd05-2aa0-40bb-accb-5697552182e3","title":"LAD Avg Weekly Resource Count Trend","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').LADUsageManSnapshot\n| project Date, Category, ResCount\n| summarize AvgResCount = round(avg(ResCount),0) by Category, week = startofmonth(Date)\n| project-reorder week, Category, AvgResCount\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"timechart","pageId":"1832124b-0c43-4edf-a1ab-59a9cda49210","layout":{"x":0,"y":13,"width":23,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"70db6334-649d-4eee-bf16-0fa0f89a088c","title":"LAD Avg Percent Usage Past Month","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').LADUsageManSnapshot\n| where Date > ago(31d)\n| project Date, Category, Usage\n| summarize AvgUsage = round(avg(Usage),2) by Category\n| project-reorder Category, AvgUsage\n| sort by AvgUsage\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"bar","pageId":"1832124b-0c43-4edf-a1ab-59a9cda49210","layout":{"x":0,"y":26,"width":23,"height":11},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Percent Usage","columns":[],"yAxisMaximumValue":100,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":true,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"c5d1d41f-f36d-4f6e-9c7b-27a8608a6b26","title":"LAD Avg Percent Usage Past Month","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').LADUsageManSnapshot\n| where Date > ago(31d)\n| project Date, Category, Usage\n| summarize AvgUsage = round(avg(Usage),2) by Category\n| project-reorder Category, AvgUsage\n| sort by AvgUsage\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"multistat","pageId":"1832124b-0c43-4edf-a1ab-59a9cda49210","layout":{"x":0,"y":37,"width":23,"height":9},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light","multiStat__displayOrientation":"horizontal","multiStat__labelColumn":{"type":"infer"},"multiStat__slot":{"width":4,"height":2}}},{"id":"c66c2cdf-b86f-482a-8844-25b55738c15c","title":"LAD Avg Resource Count Past Month","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').LADUsageManSnapshot\n| where Date > ago(31d)\n| project Date, Category, ResCount\n| summarize AvgResCount = round(avg(ResCount),2) by Category\n| project-reorder Category, AvgResCount\n| sort by AvgResCount\n","dataSourceId":"44edb3ee-923f-45bb-af7b-b82fc07fd985","visualType":"bar","pageId":"1832124b-0c43-4edf-a1ab-59a9cda49210","layout":{"x":0,"y":46,"width":23,"height":11},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Percent Usage","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":0,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":true,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}}],"parameters":[{"kind":"duration","id":"261df8e7-5dd0-4bfb-98c8-f44fb2189d2b","displayName":"Time range","beginVariableName":"_startTime","endVariableName":"_endTime","defaultValue":{"kind":"dynamic","count":1,"unit":"hours"},"showOnPages":{"kind":"all"}}],"dataSources":[{"id":"fb6da167-8074-4198-8402-5d665e70c60a","name":"azcrp","clusterUri":"https://azcrp.kusto.windows.net/","database":"crp_allprod","kind":"manual-kusto","scopeId":"kusto"},{"id":"44edb3ee-923f-45bb-af7b-b82fc07fd985","name":"genevaagent","clusterUri":"https://genevaagent.kusto.windows.net/","database":"Telemetry","kind":"manual-kusto","scopeId":"kusto"}],"pages":[{"name":"WAD usage","id":"ddc1a595-96ec-4f53-a1c8-e8ae397f23bf"},{"name":"LAD usage","id":"8d744582-1907-4072-9b20-3712e90f9e7b"},{"name":"WAD usage snap","id":"6e437167-fc29-49a3-ad23-a3aa4247eb6c"},{"id":"1832124b-0c43-4edf-a1ab-59a9cda49210","name":"LAD usage snap"}]}