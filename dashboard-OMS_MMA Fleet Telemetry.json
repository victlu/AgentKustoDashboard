{"$schema":"https://dataexplorer.azure.com/static/d/schema/24/dashboard.json","id":"6a9789fc-445a-4ea4-8bee-e9300b48b17d","eTag":"kvXnpNyRO+ZpXKvjBplaPQ==","title":"OMS_MMA Fleet Telemetry","tiles":[{"id":"b1f57641-758d-4d2e-b62f-aae93d0f9da9","title":"OMS Windows Version breakdown","query":"// OMS Windows Version breakdown\n// Agent Versions by Windows AgentId Population\n\nlet WorkspaceOS = union Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n| summarize HasWindows = countif(OSType == \"Windows\") > 0, HasLinux = countif(OSType == \"Linux\") > 0 by WorkspaceId;\nunion Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot), Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize WinAgentCount = dcountif(AgentId, OSType == \"Windows\"), WinResourceCount = dcountif(ResourceId, OSType == \"Windows\"),  WinWorkspaceCount = dcountif(WorkspaceId, OSType == \"Windows\") by AgentVersion\n| sort by WinAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":3,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"070e9c5b-affd-4a95-86a4-fd222c8538d7","title":"OMS Linux Version breakdown","query":"// OMS Linux Version breakdown\n\nlet WorkspaceOS = union\n        Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot),\n        Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n    | extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n    | summarize\n        HasWindows = countif(OSType == \"Windows\") > 0,\n        HasLinux = countif(OSType == \"Linux\") > 0\n        by WorkspaceId;\nunion\n    Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot),\n    Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| summarize\n    LnxAgentCount = dcountif(AgentId, OSType == \"Linux\"),\n    LnxResourceCount = dcountif(ResourceId, OSType == \"Linux\"),\n    LnxWorkspaceCount = dcountif(WorkspaceId, OSType == \"Linux\")\n    by AgentVersion\n| sort by LnxAgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":12,"y":3,"width":12,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[],"drillthrough":[]}},{"id":"e2a44ec0-67b8-4e4e-b642-ddb0f283d391","title":"Deployment bar chart ","query":"//Deployment bar chart \n//Azure vs On-prem vs. Arc\nlet Linux = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot) | extend OSType = \"Linux\";\nlet Windows = Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot) | extend OSType = \"Windows\";\nunion Linux, Windows\n| summarize Azure = countif(Region != \"onpremise\" and ResourceId !has \"microsoft.hybridcompute\"),\n            Direct = countif(Region == \"onpremise\" and isempty(ResourceId)),\n            Arc = countif(ResourceId has \"microsoft.hybridcompute\")\n            by OSType","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"bar","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":16,"width":24,"height":7},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"f7a44e9a-9534-4928-991c-03c32befdede","title":"Windows OMS Population count ","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot\n| where Date > now(-30d)\n| summarize count() by Date\n| summarize Population = max(count_)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":8,"y":0,"width":8,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"47225f8a-aa29-4615-820c-0221a411a52c","title":"OMS Linux population count","query":"cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot\n| where Date > now(-30d)\n| summarize count() by Date\n| summarize Population = max(count_)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":16,"y":0,"width":8,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"0a180b29-d9ff-4123-aaf6-2d15a01cf956","title":"OMS Overall Population count","query":"union cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot, cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot\n| where Date > now(-30d)\n| summarize count() by Date\n| summarize Population = max(count_)","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"card","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":0,"width":8,"height":3},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"multiStat__textSize":"auto","multiStat__valueColumn":{"type":"infer"},"colorRulesDisabled":false,"colorRules":[],"colorStyle":"light"}},{"id":"c51adfa3-448f-4834-be4b-e0e2af829ca9","title":"Solution breakdown","query":"// Agent Count by Solutions For OMS\nlet WorkspaceOS = union\n        Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot),\n        Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n    | extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\")\n    | summarize\n        HasWindows = countif(OSType == \"Windows\") > 0,\n        HasLinux = countif(OSType == \"Linux\") > 0\n        by WorkspaceId;\nunion\n    Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').LinuxDailySnapshot),\n    Latest(cluster('genevaagent.kusto.windows.net').database('Telemetry').WindowsDailySnapshot)\n| extend OSType = iff(isnotempty(OSDistro), \"Linux\", \"Windows\"), Solution = Solutions\n| join kind = leftouter WorkspaceOS on WorkspaceId\n//| where not(HasWindows) or not(HasLinux) // use this filter to eliminate 'heterogeneous' workspaces\n| mv-expand Solution to typeof(string)\n| where Solution != \"null\"\n| summarize\n    AgentCount = dcount(AgentId),\n    WinAgentCount = dcountif(AgentId, OSType == \"Windows\"),\n    LinuxAgentCount = dcountif(AgentId, OSType == \"Linux\"),\n    WorkspaceCount = dcount(WorkspaceId)\n    by Solution\n| sort by AgentCount desc","dataSourceId":"81c7dec3-36d3-46ff-96fc-9751a73cae68","visualType":"pie","pageId":"9db0948a-e66b-437f-a1a8-a5a0921776c9","layout":{"x":0,"y":23,"width":24,"height":13},"usedParamVariables":[],"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","value","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"donut","crossFilter":[],"drillthrough":[]}}],"dataSources":[{"id":"81c7dec3-36d3-46ff-96fc-9751a73cae68","name":"geneva agent","clusterUri":"https://genevaagent.kusto.windows.net/","database":"AMA","kind":"manual-kusto","scopeId":"kusto"}],"schema_version":"24","autoRefresh":{"enabled":false},"parameters":[],"pages":[{"name":"OMS","id":"9db0948a-e66b-437f-a1a8-a5a0921776c9"}]}